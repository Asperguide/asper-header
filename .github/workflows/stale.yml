name: 'Close stale issues and PRs'
on:
  schedule:
    # Run daily at 00:00 UTC
    - cron: '0 0 * * *'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v10
        with:
          # General settings
          days-before-stale: 30
          days-before-close: 14
          operations-per-run: 100
          
          # Issue settings
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had any activity for 60 days.
            
            It will be closed in 14 days if no further activity occurs.
            
            If this issue is still relevant, please leave a comment to keep it open.
            Thank you for your contributions to AsperHeader.
          
          close-issue-message: |
            This issue has been automatically closed due to inactivity.
            
            If you believe this issue is still relevant, please reopen it or create a new issue with updated information.
            Thank you for your understanding.
          
          stale-issue-label: 'stale'
          
          # PR settings
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not had any activity for 60 days.
            
            It will be closed in 14 days if no further activity occurs.
            
            If you're still working on this PR, please leave a comment to keep it open.
            Thank you for your contribution.
          
          close-pr-message: |
            This pull request has been automatically closed due to inactivity.
            
            If you'd like to continue working on this, please reopen the PR or submit a new one.
            Thank you for your contribution.
          
          stale-pr-label: 'stale'
          
          # Labels that prevent staling
          exempt-issue-labels: 'priority: critical,priority: high,security,help wanted,good first issue,needs-discussion,exempt'
          exempt-pr-labels: 'priority: critical,priority: high,security,exempt'
          
          # Labels that indicate activity
          exempt-all-milestones: true
          exempt-all-assignees: false
          
          # Don't mark as stale if recently updated
          exempt-draft-pr: true
          
          # Order to process (oldest first)
          ascending: true
          
          # Remove stale label when updated
          remove-stale-when-updated: true
          
          # Debugging (set to true for testing)
          debug-only: false
